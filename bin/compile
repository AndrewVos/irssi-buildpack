#!/usr/bin/env bash
# bin/compile <build-dir> <cache-dir>

echo "-----> Downloading IRSSI binary"
IRSSI_BINARY="http://irssi-buildpack.herokuapp.com/output/5d113eca-f133-4984-bf35-cacba8828644"
IRSSI_VENDOR="vendor/irssi"
mkdir -p $1/$IRSSI_VENDOR
curl $IRSSI_BINARY -o - | tar -xz -C $1/$IRSSI_VENDOR -f -

echo "-----> Downloading tmux binary"
TMUX_BINARY="http://irssi-buildpack.herokuapp.com/output/a90d19ef-d573-47cb-9b4c-406b72d0ae7b"
TMUX_VENDOR="vendor/tmux"
mkdir -p $1/$TMUX_VENDOR
curl $TMUX_BINARY -o - | tar -xz -C $1/$TMUX_VENDOR -f -

echo "-----> Generating the boot script"
mkdir -p $1/bin
cat >>$1/bin/boot.sh <<'EOF'
#!/usr/bin/env bash

vendor/tmux/bin/tmux
EOF
chmod +x $1/bin/boot.sh
